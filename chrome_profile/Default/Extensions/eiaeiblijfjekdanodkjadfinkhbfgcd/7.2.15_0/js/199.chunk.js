"use strict";(self.webpackChunknordpass=self.webpackChunknordpass||[]).push([[199],{3033:(e,t,a)=>{a.d(t,{r:()=>n});var s=a(74848),i=a(55910),r=a(91120);const n=e=>{var{title:t,description:a,children:n,className:o}=e,l=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["title","description","children","className"]);return(0,s.jsxs)("div",Object.assign({className:(0,i.cx)("flex flex-col items-center justify-start rounded-xl bg-[--sys-color-bg-secondary] p-12 min-h-[316px]",o)},l,{children:[(0,s.jsx)("div",{className:"flex size-16 shrink-0 items-center justify-center rounded-2xl bg-[--sys-color-bg-primary]",children:(0,s.jsx)(r.X4E,{size:44})}),(0,s.jsx)("div",{className:"mt-6 text-xl font-semibold",children:t}),(0,s.jsx)("div",{className:"mt-1 max-w-[336px] whitespace-pre-line text-center text-sm font-medium text-[--sys-color-on-bg-secondary]",children:a}),n]}))}},8769:(e,t,a)=>{a.d(t,{f:()=>r});var s=a(74848),i=a(55910);const r=e=>{var{className:t}=e,a=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(a[s[i]]=e[s[i]])}return a}(e,["className"]);return(0,s.jsx)("span",Object.assign({className:(0,i.cx)("bg-ref-color-red-50 outline-2 outline outline-[--sys-color-bg-primary] w-2 h-2 rounded-full box-content absolute right-0 top-0 z-10",t)},a))}},38955:(e,t,a)=>{a.d(t,{t:()=>p});var s=a(96540),i=a(6442),r=a(47767),n=a(45847),o=a(1876),l=a(90895),c=a(98931),d=a(42874),m=a(24291),h=a(45681),u=a(65125),x=a(61469);const p=({itemId:e,itemType:t,onSuccess:a,onError:p})=>{const y=(0,m.wA)(),{formatMessage:b}=(0,i.A)(),g=(0,r.Zp)(),{api:H}=(0,s.useContext)(c.F),T=t===d.KA.Email,f=(0,s.useCallback)(()=>{y((0,h.qM)(!1)),(0,n.y)(b({id:T?"removeEmailFromMonitoringToast":"removeCardFromMonitoringToast"})),null==a||a()},[y,T,b,a]),v=(0,s.useCallback)(()=>{y((0,h.qM)(!1)),(0,n.$)(b({id:T?"removeEmailFromMonitoringErrorToast":"removeCardFromMonitoringErrorToast"})),null==p||p()},[y,T,b,p]),{changeScannableItemStatus:j}=(0,x.H)(f,v,!1);return{onRemoveFromMonitoring:(0,s.useCallback)(()=>{(0,u.c)(()=>{return a=function*(){e&&(y((0,h.qM)(!0)),yield j(e,d.W2.NotMonitored),H.action.save(T?l.ay.DbsEmailRemoved:l.ay.DbsCCRemoved))},new((t=void 0)||(t=Promise))(function(e,s){function i(e){try{n(a.next(e))}catch(e){s(e)}}function r(e){try{n(a.throw(e))}catch(e){s(e)}}function n(a){var s;a.done?e(a.value):(s=a.value,s instanceof t?s:new t(function(e){e(s)})).then(i,r)}n((a=a.apply(undefined,[])).next())});var t,a})},[j,y,T,e,H]),onViewBreachReport:(0,s.useCallback)(()=>{H.action.save(T?l.ay.DbsEmailClicked:l.ay.DbsCCClicked),g(o.bw.DATA_BREACH_ITEM_DETAILS(e))},[H,e,g,T])}}},61199:(e,t,a)=>{a.d(t,{ItemDetailsView:()=>F});var s,i,r=a(74848),n=a(96540),o=a(58065),l=a(47767),c=a(1876),d=a(42874),m=a(24291),h=a(45681),u=a(61962),x=a(90895),p=a(98931),y=a(59993),b=a(91120),g=a(92067),H=a(6442),T=a(63440);!function(e){e.High="high",e.Low="low"}(s||(s={})),function(e){e.Credentials="Credentials",e.FinancialInformation="FinancialInformation",e.IdentityInformation="IdentityInformation",e.PersonalInformation="PersonalInformation"}(i||(i={}));const f={[i.Credentials]:{risk:s.High,dataKeys:[d.TH.Password,d.TH.PasswordHash,d.TH.PasswordHint,d.TH.SecurityQuestion,d.TH.SecurityAnswer,d.TH.EncryptedPassword,d.TH.PasswordHex,d.TH.PasswordBase64,d.TH.ApiKey]},[i.FinancialInformation]:{risk:s.High,dataKeys:[d.TH.Cc,d.TH.CcExpiration,d.TH.CcExpirationMonth,d.TH.CcExpirationYear,d.TH.Cvv,d.TH.VatNumber,d.TH.BankAccountNumber,d.TH.BankName,d.TH.Paypal,d.TH.BitcoinAddress,d.TH.EthereumAddress]},[i.IdentityInformation]:{risk:s.High,dataKeys:[d.TH.Ssn,d.TH.IDNumber,d.TH.Phone]},[i.PersonalInformation]:{risk:s.Low,dataKeys:[d.TH.Name,d.TH.FirstName,d.TH.MiddleName,d.TH.LastName,d.TH.Gender,d.TH.DateOfBirth,d.TH.Ip,d.TH.Age,d.TH.Nationality,d.TH.MaritalStatus,d.TH.RelationshipStatus,d.TH.MotherMaidenName,d.TH.FamilyMemberName,d.TH.Locale,d.TH.Location,d.TH.Country,d.TH.State,d.TH.City,d.TH.Address,d.TH.Zip,d.TH.Longitude,d.TH.Latitude,d.TH.TimeZone,d.TH.Facebook,d.TH.Twitter,d.TH.Linkedin,d.TH.SocialMedia,d.TH.Vkontakte,d.TH.Youtube,d.TH.Height,d.TH.Weight,d.TH.Race,d.TH.Ethnicity,d.TH.ShoeSize,d.TH.EyeColor,d.TH.HairColor,d.TH.BloodType,d.TH.Username,d.TH.Aim,d.TH.Msn,d.TH.Yahoo,d.TH.Skype,d.TH.StackOverflow,d.TH.Github,d.TH.Discord,d.TH.Instagram,d.TH.Telegram,d.TH.CreditRating,d.TH.Income,d.TH.Salary,d.TH.Email]}},v=new Map;Object.entries(f).forEach(([e,t])=>{t.dataKeys.forEach(a=>{v.set(a,{category:e,risk:t.risk})})});const j=(e,t,a=T.h.English)=>e.map((e=>t=>{switch(t){case i.Credentials:return e({id:"breachCredentialsLabel"});case i.FinancialInformation:return e({id:"breachFinancialInformationLabel"});case i.IdentityInformation:return e({id:"breachIdentityInformationLabel"});case i.PersonalInformation:return e({id:"breachPersonalInformationLabel"});default:return""}})(t)).filter(g.zz).toSorted((e,t)=>e.localeCompare(t,a,{sensitivity:"base"})),w=({breachedDataKeys:e})=>{const{highRiskCategories:t,lowRiskCategories:a}=(e=>{const{formatMessage:t}=(0,H.A)(),a=(0,m.d4)(y.JV);return(0,n.useMemo)(()=>{const{highRiskCategories:i,lowRiskCategories:r}=(e=>{const{highRiskSet:t,lowRiskSet:a}=e.map(e=>v.get(e)).filter(g.zz).reduce((e,{category:t,risk:a})=>(a===s.High?e.highRiskSet.add(t):e.lowRiskSet.add(t),e),{highRiskSet:new Set,lowRiskSet:new Set});return{highRiskCategories:Array.from(t),lowRiskCategories:Array.from(a)}})(e);return{highRiskCategories:j(i,t,a),lowRiskCategories:j(r,t,a)}},[e,t,a])})(e);return(0,r.jsxs)("div",{className:"flex flex-wrap gap-1","data-testid":"breach-categories-list",children:[t.map(e=>(0,r.jsx)(b.Exy,{variant:"danger","data-testid":"risk-category",children:e},e)),a.map(e=>(0,r.jsx)(b.Exy,{variant:"grey","data-testid":"risk-category",children:e},e))]})},C=({riskLevel:e})=>e===d.QH.High?(0,r.jsxs)("div",{className:"flex items-center text-xs font-medium text-[--sys-color-status-danger]","data-testid":"risk-level",children:[(0,r.jsx)(b.H$v,{}),(0,r.jsx)(o.A,{id:"high"})]}):(0,r.jsxs)("div",{className:"flex items-center text-xs font-medium text-[--sys-color-on-bg-primary]","data-testid":"risk-level",children:[(0,r.jsx)(b.H$v,{className:"[&>path:first-child]:fill-[--sys-color-on-bg-primary] [&>path:last-child]:fill-[--sys-color-on-bg-placeholder]"}),(0,r.jsx)(o.A,{id:"low"})]});var k=a(8769),A=a(8218);const I=({breachId:e,breachDetails:t,breachType:a,isNew:s})=>{var i;const{api:h}=(0,n.useContext)(p.F),H=(0,l.Zp)(),T=null!==(i=(0,g.Dl)(t.logo_url||"").domain)&&void 0!==i?i:t.name,f=(0,m.d4)(y.JV),{isMobile:v}=(0,b.QsY)();return(0,r.jsx)(b.SV4,{title:t.name,description:(0,A.X)({breachDate:t.breached_at,locale:f}),icon:(0,r.jsxs)("div",{className:"relative",children:[s&&(0,r.jsx)(k.f,{"data-testid":"new-asset-badge"}),(0,r.jsx)(u.x,{item:{uuid:e,type:"breach",url:T,title:t.name},size:"sm"})]}),actions:(0,r.jsx)(b.$nd,{"data-testid":"view-details-button",rank:"secondary",onClick:()=>{a&&h.action.save(a===d.KA.Email?x.ay.DbsEmailBreachClicked:x.ay.DbsCCBreachClicked),H(c.bw.DATA_BREACH_DETAILS(e))},children:(0,r.jsx)(o.A,{id:v?"view":"viewDetails"})}),"data-testid":"breach-item",children:(0,r.jsx)(b.wn6,{children:(0,r.jsx)(b.Oas,{children:(0,r.jsxs)("div",{className:"grid auto-rows-auto grid-cols-[100px_1fr] items-start gap-x-6 gap-y-2",children:[(0,r.jsx)("span",{className:"truncate text-xs font-medium text-[--sys-color-on-bg-tertiary]","data-testid":"risk-level-label",children:(0,r.jsx)(o.A,{id:"riskLevel"})}),(0,r.jsx)("span",{className:"truncate text-xs font-medium text-[--sys-color-on-bg-tertiary]","data-testid":"exposed-data-label",children:(0,r.jsx)(o.A,{id:"exposedData"})}),(0,r.jsx)(C,{riskLevel:t.priority}),(0,r.jsx)(w,{breachedDataKeys:t.breached_data_keys})]})})})})};var S=a(3033);const E=()=>(0,r.jsx)(S.r,{title:(0,r.jsx)(o.A,{id:"noBreaches"}),description:(0,r.jsx)(o.A,{id:"noBreachesDescription"})});var N=a(11243),_=a(54262),M=a(38955);const R={[d.KA.Email]:(0,r.jsx)(b.aZ_,{}),[d.KA.Card]:(0,r.jsx)(b.BFk,{})},D=({scannableItem:e})=>{const[t,a]=(0,n.useState)(!1),s=(0,l.Zp)(),i=(0,m.wA)(),{onRemoveFromMonitoring:u}=(0,M.t)({itemId:e.uuid,itemType:e.item_type,onSuccess:()=>{i((0,h.OO)(e.item_type)),s(c.bw.DATA_BREACH,{replace:!0})}}),{icon:x,title:p}=(0,n.useMemo)(()=>({icon:R[e.item_type],title:e.item_type===d.KA.Card?(0,N.aM)(e.item_value):e.item_value}),[e.item_type,e.item_value]);return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(_.a,{isDestructiveConfirmation:!0,header:(0,r.jsx)(o.A,{id:"stopMonitoringAssetTitle",values:{type:e.item_type}}),content:(0,r.jsx)(o.A,{id:"stopMonitoringAssetDescription"}),action:u,actionText:(0,r.jsx)(o.A,{id:"stopMonitoring"}),onClose:()=>a(!1)}),(0,r.jsx)(b.SV4,{icon:(0,r.jsx)(b.ijn,{children:x}),title:p,actions:(0,r.jsx)(b.rId,{isResponsive:!1,ButtonComponent:({onClick:e})=>(0,r.jsx)(b.$nd,{rank:"secondary","data-testid":"monitor-asset-actions_more-options",icon:(0,r.jsx)(b.Z4s,{}),iconPosition:"left",onClick:e}),children:(0,r.jsx)(b.tJh,{className:"whitespace-nowrap text-[--sys-color-status-danger]",title:(0,r.jsx)(o.A,{id:"stopMonitoring"}),"data-testid":"monitor-asset-actions_stop-monitoring",onClick:()=>a(!0)})})})]})};var O=a(80066),B=a(58997);const F=()=>{var e,t;const a=(0,l.Zp)(),s=(0,m.wA)(),i=null!==(e=(0,l.g)().itemId)&&void 0!==e?e:"",u=(0,m.d4)(h.w8),x=null!==(t=(0,m.d4)(h.Cy))&&void 0!==t?t:[],p=(0,O.s9)(i,u),y=(0,O.gc)(i,null!=x?x:[]),b=(0,n.useMemo)(()=>{const{nonResolvedBreaches:e,resolvedBreaches:t}=(0,O.UM)(y);return[{title:(0,r.jsx)(o.A,{id:"unresolvedBreaches"}),breaches:(0,O.cx)(e)},{title:(0,r.jsx)(o.A,{id:"resolvedBreaches"}),breaches:(0,O.cx)(t)}]},[y]),g=(0,n.useCallback)(()=>{s((0,h.OO)(null==p?void 0:p.item_type)),a(c.bw.DATA_BREACH)},[s,null==p?void 0:p.item_type,a]);return(0,n.useEffect)(()=>{p||a(c.bw.DATA_BREACH,{replace:!0})},[p,a]),(0,r.jsx)(B.M,{headerContent:(0,r.jsx)(o.A,{id:"breachReport"}),bodyClassName:"py-8 pr-18",onGoBack:g,children:(0,r.jsxs)("div",{className:"mx-auto flex w-full min-w-[424px] max-w-[1200px] flex-col gap-y-8","data-testid":"data-breach-item-details-view",children:[p&&(0,r.jsx)(D,{scannableItem:p}),y.length>0?(0,r.jsx)("div",{className:"mx-auto flex w-full flex-col gap-y-8",children:b.map(({breaches:e,title:t},a)=>e.length>0&&(0,r.jsxs)("div",{className:"flex flex-col gap-y-6","data-testid":"breaches-group",children:[(0,r.jsx)("span",{className:"[font:--sys-text-heading-h3]",children:t}),(0,r.jsx)("ul",{className:"flex flex-col gap-y-4",children:e.map(e=>(0,r.jsx)(I,{breachId:e.breached_item_identifier,breachDetails:e.breach_details,breachType:null==p?void 0:p.item_type,isNew:e.breached_item_status===d.EG.New},e.breached_item_identifier))})]},a))}):(0,r.jsx)(E,{})]})})}},61469:(e,t,a)=>{a.d(t,{H:()=>c});var s=a(74848),i=a(58065),r=a(45847),n=a(78522),o=a(81841),l=a(90867);const c=(e,t,a=!0)=>{const c=e=>{null==t||t(),a&&(0,r.$)((0,o.u)(e,(0,s.jsx)(i.A,{id:"somethingWentWrongTryAgain"})))},{action:d,isLoading:m}=(0,n.y)(l.FH.breachReport.createScannableItem,{onSuccess:e,onError:c}),{action:h,isLoading:u}=(0,n.y)(l.FH.breachReport.changeScannableItemStatus,{onSuccess:e,onError:c}),{action:x}=(0,n.y)(l.FH.breachReport.dismissScannableItem,{onSuccess:e,onError:c});return{createScannableItem:d,changeScannableItemStatus:h,dismissScannableItem:x,isLoading:m||u}}}}]);
//# sourceMappingURL=199.chunk.js.map