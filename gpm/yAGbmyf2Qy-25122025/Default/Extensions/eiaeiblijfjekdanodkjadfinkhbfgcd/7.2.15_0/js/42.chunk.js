"use strict";(self.webpackChunknordpass=self.webpackChunknordpass||[]).push([[42],{22870:(e,s,a)=>{a.d(s,{x:()=>R});var t,r,n=a(74848),i=a(58065),d=a(41196),o=a(96540);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)({}).hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},l.apply(null,arguments)}const c=(e,s)=>o.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:s},e),t||(t=o.createElement("g",{fill:"#383C43",fillRule:"evenodd",clipPath:"url(#data-breach-lock_svg__a)",clipRule:"evenodd"},o.createElement("path",{d:"M12 14.008a1 1 0 0 1 1 1v3a1 1 0 1 1-2 0v-3a1 1 0 0 1 1-1M8 5.587c.225-1.358.817-2.253 1.528-2.805.734-.57 1.662-.826 2.606-.776 1.912.103 3.673 1.425 3.87 3.587l1.992-.181C17.693 2.08 14.954.155 12.24.01c-1.368-.073-2.784.295-3.94 1.194-1.168.907-2.005 2.302-2.29 4.152L6 5.431v3.578h2z"}),o.createElement("path",{d:"M6 9.008h12a3 3 0 0 1 3 3v9a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-9a3 3 0 0 1 3-3m0 2a1 1 0 0 0-1 1v9a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-9a1 1 0 0 0-1-1z"}))),r||(r=o.createElement("defs",null,o.createElement("clipPath",{id:"data-breach-lock_svg__a"},o.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"}))))),x=(0,o.forwardRef)(c),h=(0,o.memo)(x);var u;function p(){return p=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)({}).hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},p.apply(null,arguments)}const m=(e,s)=>o.createElement("svg",p({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:s},e),u||(u=o.createElement("path",{fill:"#383C43",d:"m3.313 15.505 2.914-1.94.572-6.282A5.72 5.72 0 0 1 12.5 2.087a5.72 5.72 0 0 1 5.7 5.196l.573 6.282 2.914 1.94a.5.5 0 0 1 .222.413v1.821H3.091v-1.82a.5.5 0 0 1 .222-.414m13.369 4.321h5.227c1.155 0 2.091-.934 2.091-2.087v-1.82c0-.865-.433-1.672-1.153-2.15l-2.082-1.387-.482-5.288A7.81 7.81 0 0 0 12.5 0a7.81 7.81 0 0 0-7.783 7.094l-.482 5.288-2.082 1.386A2.58 2.58 0 0 0 1 15.918v1.821c0 1.153.936 2.087 2.09 2.087h5.228A4.18 4.18 0 0 0 12.5 24a4.18 4.18 0 0 0 4.182-4.174m-2.091 0a2.09 2.09 0 0 1-2.091 2.087 2.09 2.09 0 0 1-2.09-2.087z"}))),w=(0,o.forwardRef)(m),g=(0,o.memo)(w);var f,j;function v(){return v=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)({}).hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},v.apply(null,arguments)}const P=(e,s)=>o.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",ref:s},e),f||(f=o.createElement("path",{fill:"#383C43",d:"M16.858 8.515a1 1 0 0 0-1.716-1.03l-3.786 6.31L9.26 11.35a1 1 0 0 0-1.518 1.302l3 3.5a1 1 0 0 0 1.617-.136z"})),j||(j=o.createElement("path",{fill:"#383C43",fillRule:"evenodd",d:"M12.006 24c-.237 0-.573-.084-.897-.25C4.005 20.125 1.5 18.36 1.5 14.092V5.33c0-1.538.573-2.158 1.97-2.706 1.283-.5 5.77-2.015 7.016-2.385C10.959.108 11.52 0 12.006 0c.474 0 1.047.095 1.52.238 1.235.382 5.721 1.872 7.017 2.385 1.384.56 1.957 1.168 1.957 2.706v8.763c0 4.269-2.418 6.176-9.596 9.658-.325.155-.661.25-.898.25M4.198 4.485C5.42 4.01 9.81 2.527 11.036 2.161c.379-.103.739-.161.97-.161.247 0 .621.057.937.151 1.232.382 5.627 1.843 6.857 2.329.473.192.616.31.646.338.017.047.054.19.054.511v8.763c0 1.638-.416 2.646-1.493 3.683-1.241 1.195-3.358 2.42-6.97 4.172l-.032.015c-3.593-1.834-5.724-3.059-6.992-4.255-.596-.561-.95-1.072-1.167-1.59-.22-.522-.346-1.157-.346-2.025V5.33c0-.324.037-.467.055-.514.03-.028.176-.146.643-.33m16.239.314q0 0 .007.015-.008-.014-.007-.015M3.564 4.796l-.007.014z",clipRule:"evenodd"}))),b=(0,o.forwardRef)(P),k=(0,o.memo)(b);var y,C;function N(){return N=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)({}).hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},N.apply(null,arguments)}const A=(e,s)=>o.createElement("svg",N({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",ref:s},e),y||(y=o.createElement("path",{fill:"#383C43",d:"M6.745 20.858c-1.197-.135-1.778-.376-2.18-.685a4 4 0 0 1-.738-.738c-.309-.402-.55-.983-.685-2.18C3.003 16.02 3 14.393 3 12s.003-4.019.142-5.255c.135-1.197.376-1.778.685-2.18a4 4 0 0 1 .738-.738c.402-.309.983-.55 2.18-.685C7.98 3.003 9.608 3 12 3s4.019.003 5.256.142c1.196.135 1.777.376 2.179.685.277.212.526.46.738.738.309.402.55.983.685 2.18C20.997 7.98 21 9.608 21 12s-.003 4.019-.142 5.256c-.135 1.196-.376 1.777-.685 2.179a4 4 0 0 1-.738.738c-.402.309-.983.55-2.18.685C16.02 20.997 14.393 21 12 21s-4.019-.003-5.255-.142M2.24 3.348C1 4.962 1 7.307 1 12s0 7.037 1.24 8.653a6 6 0 0 0 1.107 1.107C4.963 23 7.31 23 12 23s7.037 0 8.653-1.24c.416-.32.788-.691 1.107-1.107C23 19.037 23 16.69 23 12s0-7.037-1.24-8.653a6 6 0 0 0-1.107-1.107C19.037 1 16.69 1 12 1S4.963 1 3.347 2.24A6 6 0 0 0 2.24 3.347"})),C||(C=o.createElement("path",{fill:"#383C43",d:"M19.822 7.431a1 1 0 0 1-.253 1.391l-6.05 4.187a3 3 0 0 1-3.489-.053L4.406 8.805a1 1 0 1 1 1.188-1.61l5.624 4.152a1 1 0 0 0 1.163.017l6.05-4.186a1 1 0 0 1 1.391.253"}))),E=(0,o.forwardRef)(A),S=(0,o.memo)(E);var H,O;function M(){return M=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var t in a)({}).hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},M.apply(null,arguments)}const T=(e,s)=>o.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",ref:s},e),H||(H=o.createElement("path",{fill:"#383C43",fillRule:"evenodd",d:"M12.006 24c-.237 0-.573-.084-.897-.25C4.005 20.125 1.5 18.36 1.5 14.092V5.33c0-1.538.573-2.158 1.97-2.706 1.283-.5 5.77-2.015 7.016-2.385C10.959.108 11.52 0 12.006 0c.474 0 1.047.095 1.52.238 1.235.382 5.721 1.872 7.017 2.385 1.384.56 1.957 1.168 1.957 2.706v8.763c0 4.269-2.418 6.176-9.596 9.658-.325.155-.661.25-.898.25M4.198 4.485C5.42 4.01 9.81 2.527 11.036 2.161c.379-.103.739-.161.97-.161.247 0 .621.057.937.151 1.232.382 5.627 1.843 6.857 2.329.473.192.616.31.646.338.017.047.054.19.054.511v8.763c0 1.638-.416 2.646-1.493 3.683-1.241 1.195-3.358 2.42-6.97 4.172l-.032.015c-3.593-1.834-5.724-3.059-6.992-4.255-.596-.561-.95-1.072-1.167-1.59-.22-.522-.346-1.157-.346-2.025V5.33c0-.324.037-.467.055-.514.03-.028.176-.146.643-.33m16.239.314q0 0 .007.015-.008-.014-.007-.015M3.564 4.796l-.007.014z",clipRule:"evenodd"})),O||(O=o.createElement("path",{fill:"#383C43",fillRule:"evenodd",d:"M13.189 11.22a2.22 2.22 0 1 0-1.877.028l-1.049 4.17a.468.468 0 0 0 .454.582h3.119c.306 0 .53-.29.452-.586z",clipRule:"evenodd"}))),L=(0,o.forwardRef)(T),F=(0,o.memo)(L);var I=a(91120);const R=e=>{switch(e){case d.e.EmailMasking:return[{title:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingIdentityTitle"}),description:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingIdentitySubtitle"}),icon:(0,n.jsx)(I.QDW,{width:24,height:24})},{title:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingShieldTitle"}),description:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingShieldSubtitle"}),icon:(0,n.jsx)(F,{className:"nordpass-svg",width:24,height:24})},{title:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingInboxTitle"}),description:(0,n.jsx)(i.A,{id:"emailMaskingOnboardingInboxSubtitle"}),icon:(0,n.jsx)(S,{className:"nordpass-svg",width:24,height:24})}];case d.e.BreachScanner:return[{title:(0,n.jsx)(i.A,{id:"dataBreachOnboardingScanningTitle"}),description:(0,n.jsx)(i.A,{id:"dataBreachOnboardingScanningSubtitle"}),icon:(0,n.jsx)(h,{className:"nordpass-svg",width:24,height:24})},{title:(0,n.jsx)(i.A,{id:"dataBreachOnboardingNotificationsTitle"}),description:(0,n.jsx)(i.A,{id:"dataBreachOnboardingNotificationsSubtitle"}),icon:(0,n.jsx)(g,{className:"nordpass-svg",width:24,height:24})},{title:(0,n.jsx)(i.A,{id:"dataBreachOnboardingProtectTitle"}),description:(0,n.jsx)(i.A,{id:"dataBreachOnboardingProtectSubtitle"}),icon:(0,n.jsx)(k,{className:"nordpass-svg",width:24,height:24})}];case d.e.PasswordHealth:return[{title:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingExposedPasswordsTitle"}),description:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingExposedPasswordsSubtitle"}),icon:(0,n.jsx)(I.O9m,{className:"nordpass-svg",width:24,height:24})},{title:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingWeakPasswordsTitle"}),description:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingWeakPasswordsSubtitle"}),icon:(0,n.jsx)(I.GwM,{className:"nordpass-svg",width:28,height:28})},{title:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingReusedPasswordsTitle"}),description:(0,n.jsx)(i.A,{id:"passwordHealthOnboardingReusedPasswordsSubtitle"}),icon:(0,n.jsx)(I.RI7,{className:"nordpass-svg",width:24,height:24})}];default:return[]}}},41196:(e,s,a)=>{a.d(s,{M:()=>c,e:()=>t});var t,r=a(74848),n=a(58065),i=a(55910),d=a(34354),o=a(91120);!function(e){e.BreachScanner="breach-scanner",e.PasswordHealth="password-health",e.EmailMasking="email-masking"}(t||(t={}));const l=e=>{switch(e){case t.BreachScanner:return"bg-[url('@images/backgrounds/breach-scanner.svg?url')]";case t.PasswordHealth:return"bg-[url('@images/backgrounds/password-health.svg?url')]";case t.EmailMasking:return"bg-[url('@images/backgrounds/email-masking.svg?url')]";default:return}},c=({type:e,headerText:s,buttonText:a=(0,r.jsx)(n.A,{id:"upgradeToPremium"}),onClick:t})=>(0,r.jsxs)("div",{className:(0,i.cx)(l(e),"bg-no-repeat bg-cover bg-center h-[200px] rounded-lg px-6 py-8 flex flex-col items-center justify-between max-w-[1000px] w-full mx-auto"),"data-testid":"promo-banner",children:[(0,r.jsx)("h1",{className:"my-auto whitespace-pre-line text-center text-2xl font-bold text-white","data-testid":"promo-banner-description",children:s}),!d.ax&&(0,r.jsx)(o.$nd,{theme:"dark",rank:"primary",kind:"contained",size:"large",className:"mt-4 w-[360px] px-5 py-3","data-testid":"promo-banner-button",onClick:t,children:(0,r.jsx)("span",{className:"text-base font-bold",children:a})})]})},42348:(e,s,a)=>{a.d(s,{n:()=>u});var t=a(74848),r=a(41196),n=a(91912),i=a(93586),d=a(58065);const o=e=>{switch(e){case r.e.EmailMasking:return(0,t.jsx)(d.A,{id:"emailMaskingOnboardingTitle"});case r.e.BreachScanner:return(0,t.jsx)(d.A,{id:"dataBreachOnboardingTitle"});case r.e.PasswordHealth:return(0,t.jsx)(d.A,{id:"passwordHealthOnboardingTitle"});default:return""}};var l=a(22870);const c=({type:e})=>(0,t.jsx)(n.w,{title:o(e),className:"mt-6",children:(0,l.x)(e).map(({title:e,description:s,icon:a},r)=>(0,t.jsx)(i.O,{title:e,description:s,colorClassNameDescription:"text-[--dmd-2] dark:text-grey",icon:(0,t.jsx)("span",{className:"mr-5 flex size-[50px] items-center justify-center rounded-full bg-grey-light/20 dark:bg-dmd-1/20",children:a})},r))});var x=a(34354);const h=e=>{if(x.ax)switch(e){case r.e.EmailMasking:return(0,t.jsx)(d.A,{id:"emailMaskingPremiumFeature"});case r.e.BreachScanner:return(0,t.jsx)(d.A,{id:"breachScannerPremiumFeature"});case r.e.PasswordHealth:return(0,t.jsx)(d.A,{id:"passwordHealthPremiumFeature"});default:return""}switch(e){case r.e.EmailMasking:return(0,t.jsx)(d.A,{id:"emailMaskingPromoHeading"});case r.e.BreachScanner:return(0,t.jsx)(d.A,{id:"breachScannerPromoHeading"});case r.e.PasswordHealth:return(0,t.jsxs)("p",{children:[(0,t.jsx)(d.A,{id:"passwordHealthPromoHeading1"}),(0,t.jsx)("br",{}),(0,t.jsx)(d.A,{id:"passwordHealthPromoHeading2"})]});default:return""}},u=({type:e,onClick:s,buttonText:a})=>(0,t.jsxs)("div",{className:"mx-auto w-full max-w-[1000px]",children:[(0,t.jsx)(r.M,{type:e,headerText:h(e),buttonText:a,onClick:s}),(0,t.jsx)(c,{type:e})]})},49042:(e,s,a)=>{a.d(s,{PasswordHealth:()=>Ee});var t,r=a(74848),n=a(96540),i=a(32017),d=a.n(i),o=a(58065),l=a(41196),c=a(79459),x=a(20990),h=a(92561),u=a(90895),p=a(35389),m=a(44684),w=a(38846),g=a(24291),f=a(69883),j=a(45681),v=a(9908),P=a(86981),b=a(55910),k=a(73834),y=a(91511),C=a(74229),N=a(79273),A=a(95607),E=a(62865);!function(e){e[e.Empty=0]="Empty",e[e.Weak=1]="Weak",e[e.Moderate=2]="Moderate",e[e.Strong=3]="Strong"}(t||(t={}));var S=a(1231);var H=a(93492),O=a(18),M=a(90867),T=a(42348),L=a(53351),F=a(74754),I=a(58997),R=a(38958),z=a(6442),B=a(91912),$=a(93586),_=a(16224),D=a(35763),W=a(64012),U=a(73890),G=a(24923),Q=a(40731),V=a(61415),q=a(91120),J=a(92067);const K=({header:e,items:s,sectionClassName:a})=>{const{formatMessage:t}=(0,z.A)(),i=(0,U.i)(W.T.FileStorage),[d,l]=(0,n.useState)({}),c=e=>{const s=(0,G.u)(e);M.FH.action.save(u.ay.PasswordHealthChangeTap),(0,J.Dl)(s).domain?(0,L.k)(s).catch(x.f):(0,D.P0)(D.Et.ActionFeedback,{bodyText:t({id:"invalidUrlError"})})};return(0,r.jsx)(B.w,{header:e,className:a,children:s.map(e=>{var s;return(0,r.jsx)($.O,{"data-testid":`password-item-${e.uuid}`,className:"group h-22 cursor-auto py-4 [contain-intrinsic-size:88px] [content-visibility:auto] hover:bg-[--sys-color-container-hover]",title:(0,r.jsx)("div",{className:"flex min-h-[39px] items-center font-medium",children:(0,r.jsx)(_.L,{item:e,shouldShowSharedIcon:e.shared,shouldShowAttachmentIcon:i&&(0,Q.S)(e),children:(0,r.jsx)("p",{"data-testid":"password-item__secret",className:"pt-1 text-xs leading-[14px] tracking-[-.12px] text-grey-dark dark:text-[--dmd-1]",children:d[e.uuid]?(0,V.e)(null!==(s=e.secret)&&void 0!==s?s:""):"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})})}),children:(0,r.jsxs)("div",{className:"hidden group-hover:flex",children:[(0,r.jsx)(q.m_M,{title:d[e.uuid]?(0,r.jsx)(o.A,{id:"hidePassword"}):(0,r.jsx)(o.A,{id:"showPassword"}),placement:"top",children:(0,r.jsx)(q.$nd,{kind:"plain","data-testid":d[e.uuid]?`hide-password-${e.uuid}`:`show-password-${e.uuid}`,icon:d[e.uuid]?(0,r.jsx)(q.WKY,{}):(0,r.jsx)(q.nNk,{}),className:"mr-2",onClick:s=>{s.stopPropagation(),l(s=>Object.assign(Object.assign({},s),{[e.uuid]:!s[e.uuid]})),M.FH.action.save(u.ay.PasswordHealthShowPasswordTap)}})}),e.url&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.$nd,{className:"hidden capitalize min-[901px]:flex","data-testid":`change-password-${e.uuid}`,kind:"plain",icon:(0,r.jsx)(q.FQm,{}),onClick:s=>{s.stopPropagation(),c(e.url)},children:(0,r.jsx)(o.A,{id:"changePassword"})}),(0,r.jsx)(q.m_M,{title:(0,r.jsx)(o.A,{id:"changePassword"}),placement:"top",children:(0,r.jsx)(q.$nd,{className:"hidden capitalize max-[900px]:flex","data-testid":`change-password-${e.uuid}`,kind:"plain",icon:(0,r.jsx)(q.FQm,{}),iconPosition:"right",onClick:s=>{s.stopPropagation(),c(e.url)}})})]})]})},e.uuid)})})};var X=a(44416),Y=a(72311),Z=a(51008),ee=a(40695);const se=()=>{const e=(0,g.wA)(),s=(0,g.d4)(f.B$),a=(0,g.d4)(e=>(0,ee.vb)(e,s));return(0,n.useEffect)(()=>{!a&&s&&e((0,ee.fn)({[(0,Z.qD)(Z.lG.HasSeenExposedPasswordsExplanation,s)]:!0}))},[e,a,s]),(0,r.jsxs)(X.n,{isExpandedInitially:!a,containerClassName:"mb-5","data-testid":"exposed-passwords-info",title:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.O9m,{}),(0,r.jsx)("p",{className:"ml-4 mr-3 flex-1 text-base font-bold leading-6","data-testid":"exposed-passwords-info-title",children:(0,r.jsx)(o.A,{id:"exposedPasswordsInfoTitle"})})]}),children:[(0,r.jsx)("p",{className:"pl-16 pt-2 text-base leading-6 tracking-[-.16px] text-ref-color-grey-70 dark:text-ref-color-grey-40","data-testid":"exposed-passwords-info-text",children:(0,r.jsx)(o.A,{id:"exposedPasswordsInfoDescription"})}),(0,r.jsx)("p",{className:"p-6 pl-16 pt-2 text-base",children:(0,r.jsx)(q.N_E,{isTargetBlank:!0,href:Y.U.ExposedPasswordsLearnMore,children:(0,r.jsx)(o.A,{id:"learnMore"})})}),(0,r.jsx)("p",{className:"pl-16 pt-2 text-base font-medium leading-6 tracking-[-.16px] text-ref-color-grey-90 dark:text-ref-color-grey-0","data-testid":"exposed-passwords-info-text",children:(0,r.jsx)(o.A,{id:"exposedPasswordsInfoCTA"})}),(0,r.jsxs)("div",{className:"mb-2 mt-3 flex","data-testid":"exposed-passwords-info-text",children:[(0,r.jsx)("div",{className:"mx-5 flex max-h-6 min-h-6 min-w-6 max-w-6 items-center justify-center rounded-full bg-ref-color-grey-10 dark:bg-ref-color-grey-75",children:"1"}),(0,r.jsx)("p",{className:"text-base text-ref-color-grey-70 dark:text-ref-color-grey-40",children:(0,r.jsx)(o.A,{id:"exposedPasswordsInfoCTAstep1"})})]}),(0,r.jsxs)("div",{className:"mb-4 mt-2 flex","data-testid":"exposed-passwords-info-text",children:[(0,r.jsx)("div",{className:"mx-5 flex max-h-6 min-h-6 min-w-6 max-w-6 items-center justify-center rounded-full bg-ref-color-grey-10 dark:bg-ref-color-grey-75",children:"2"}),(0,r.jsx)("p",{className:"text-base text-ref-color-grey-70 dark:text-ref-color-grey-40",children:(0,r.jsx)(o.A,{id:"exposedPasswordsInfoCTAstep2"})})]})]})};var ae=a(45847),te=a(28696),re=a(98931),ne=a(78522),ie=a(3428),de=a(24004);const oe=({isLoading:e,secret:s})=>e?(0,r.jsx)(q.UdL,{size:"small","data-testid":"password-item__secret-skeleton"}):(0,V.e)(null!=s?s:""),le="\u2022".repeat(17),ce=(0,ie.sF)("ExposedPasswordsListItem",({item:e})=>{const{formatMessage:s}=(0,z.A)(),{api:a}=(0,n.useContext)(re.F),t=(0,U.i)(W.T.FileStorage),[i,d]=(0,n.useState)(!1),[l,c]=(0,n.useState)(""),h=(0,n.useCallback)(e=>{var s;null!==e&&(0,S.we)(e)&&c(null!==(s=null==e?void 0:e.secret)&&void 0!==s?s:"")},[]),{action:p,isLoading:m}=(0,ne.y)(a.item.fetchItem,{onError:x.f,onSuccess:h}),w=(0,n.useCallback)(e=>{const t=(0,de.L)(e);a.action.save(u.ay.PasswordHealthChangeTap),t?(0,L.k)(t).catch(x.f):(0,ae.$)(s({id:"invalidUrlError"}))},[a,s]);return(0,n.useEffect)(()=>{i&&p(e.uuid,te.ls.ViewSecret).catch(x.f)},[p,e.uuid,i]),(0,r.jsx)($.O,{"data-testid":`password-item-${e.uuid}`,className:"h-22 group cursor-auto py-4 [contain-intrinsic-size:88px] [content-visibility:auto] hover:bg-[--sys-color-container-hover]",title:(0,r.jsx)("div",{className:"flex min-h-[39px] items-center font-medium",children:(0,r.jsx)(_.L,{item:e,shouldShowSharedIcon:e.shared,shouldShowAttachmentIcon:t&&(0,Q.S)(e),children:(0,r.jsx)("p",{"data-testid":"password-item__secret",className:(0,q.cx)("pt-1 text-xs leading-[14px] tracking-[-.12px] text-grey-dark dark:text-[--dmd-1]"),children:i?(0,r.jsx)(oe,{isLoading:m,secret:l}):le})})}),children:(0,r.jsxs)("div",{className:"hidden group-hover:flex",children:[(0,r.jsx)(q.m_M,{title:i?(0,r.jsx)(o.A,{id:"hidePassword"}):(0,r.jsx)(o.A,{id:"showPassword"}),placement:"top",children:(0,r.jsx)(q.$nd,{kind:"plain","data-testid":i?`hide-password-${e.uuid}`:`show-password-${e.uuid}`,icon:i?(0,r.jsx)(q.WKY,{}):(0,r.jsx)(q.nNk,{}),className:"mr-2",onClick:e=>{e.stopPropagation(),d(e=>!e),a.action.save(u.ay.PasswordHealthShowPasswordTap)}})}),e.url&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.$nd,{className:"hidden capitalize min-[901px]:flex","data-testid":`change-password-${e.uuid}`,kind:"plain",icon:(0,r.jsx)(q.FQm,{}),onClick:s=>{s.stopPropagation(),w(e.url)},children:(0,r.jsx)(o.A,{id:"changePassword"})}),(0,r.jsx)(q.m_M,{title:(0,r.jsx)(o.A,{id:"changePassword"}),placement:"top",children:(0,r.jsx)(q.$nd,{className:"hidden capitalize max-[900px]:flex","data-testid":`change-password-${e.uuid}`,kind:"plain",icon:(0,r.jsx)(q.FQm,{}),iconPosition:"right",onClick:s=>{s.stopPropagation(),w(e.url)}})})]})]})},e.uuid)}),xe=()=>{const e=(0,g.d4)(j.dK,d());return(0,r.jsx)(B.w,{dataTestId:"vault-scroll",children:e.map(e=>(0,r.jsx)(ce,{item:e},e.uuid))})},he=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(se,{}),(0,r.jsx)(xe,{})]});var ue=a(73267),pe=a(22246),me=a(39425),we=a(65238),ge=a(59993),fe=a(86524);const je=({icon:e,title:s,description:a,accountCount:t,iconWrapperClassName:n,titleClassName:i,testId:d,children:l})=>(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,r.jsx)("div",{className:(0,b.cx)("flex items-center justify-center text-white rounded-full w-10 h-10",n),children:e}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:(0,b.cx)("text-base leading-[1.3]",i),children:s}),(0,r.jsx)("div",{className:"text-sm leading-[1.3] text-grey-dark dark:text-[--dmd-1]",children:a})]})]}),l||(0,r.jsx)("div",{className:"text-xl font-bold leading-none text-grey-dark dark:text-[--dmd-1]","data-testid":d,children:(0,r.jsx)(o.A,{id:"accountCount",values:{count:t,stylized:(0,r.jsx)("span",{className:"text-[40px] text-grey-darkest dark:text-white",children:t})}})})]}),ve=({breachedPasswordsCount:e,children:s})=>{const{formatMessage:a}=(0,z.A)();return(0,r.jsx)(je,{accountCount:e,icon:(0,r.jsx)(q.O9m,{width:16,height:16,className:"nordpass-svg"}),title:a({id:"exposedPasswordsTitle"}),description:a({id:"exposedPasswordsDescription"}),titleClassName:"text-ref-color-orange-50",iconWrapperClassName:"bg-ref-color-orange-40",testId:"exposedpasswords",children:s})},Pe=()=>(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"mb-10 flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(q.LIN,{})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(q.UdL,{size:"small",className:"ml-4 w-[218px]"}),(0,r.jsx)(q.UdL,{size:"small",className:"ml-4 mt-3 w-36"})]})]}),(0,r.jsx)("div",{className:"text-xl font-bold leading-none text-grey-dark dark:text-[--dmd-1]",children:(0,r.jsx)(q.UdL,{size:"small",className:"w-[106px]"})})]}),be=({isLoading:e,children:s})=>(0,r.jsx)(B.w,{children:e?(0,r.jsx)($.O,{title:(0,r.jsx)(Pe,{})}):s});var ke;!function(e){e.Weak="weak",e.Reused="reused",e.Old="old",e.Exposed="exposed"}(ke||(ke={}));const ye=({isLoading:e,onSectionSelect:s})=>{const a=(0,g.d4)(ge.OL),t=(0,g.d4)(j.cl),i=(0,g.wA)(),{isFreeUser:d}=(0,p.d)(),{isBusiness:l,isPremium:c}=(0,we.C)(),h=(0,g.d4)(j.Ad),w=(0,g.d4)(j.wD),{isOrganizationExposedPasswordsEnabled:f,hasAcceptedPasswordHealthConsent:P,isExposedPasswordsEnabled:k,hasInitiallyScannedVaultPasswords:y,shouldShowPasswordHealthConsentModal:C}=(0,m.J)(),N=k&&(c||l&&f),A=k&&P&&c&&!h&&!y,E=(0,fe.x)(h,0,700),S=(0,n.useCallback)(()=>{return s=function*(){d||P?A&&(i((0,j.Eg)(!0)),i((0,j.u$)(void 0)),yield M.FH.breachReport.getBreachedPasswords().catch(x.f),i((0,j.Eg)(!1))):i((0,O.LQ)({type:v.q.PasswordHealthConsent}))},new((e=void 0)||(e=Promise))(function(a,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function n(e){try{i(s.throw(e))}catch(e){t(e)}}function i(s){var t;s.done?a(s.value):(t=s.value,t instanceof e?t:new e(function(e){e(t)})).then(r,n)}i((s=s.apply(undefined,[])).next())});var e,s},[i,P,d,A]);(0,n.useEffect)(()=>{C&&i((0,O.LQ)({type:v.q.PasswordHealthConsent}))},[i,C]);const H=()=>a?P||l?w?(0,r.jsx)("div",{className:"text-grey-dark mt-4 text-sm dark:text-[--dmd-1]",children:(0,r.jsx)(o.A,{id:"couldntLoadResults",values:{retryLink:(0,r.jsx)(q.N_E,{role:"button",onClick:S,children:(0,r.jsx)(o.A,{id:"refresh"})})}})}):null:(0,r.jsxs)("div",{className:"border-grey-lighter dark:border-grey-dark/20 mt-2 flex items-center gap-3 border-t pt-6",children:[(0,r.jsx)(q.$nd,{rank:"secondary","data-testid":"exposed-passwords-consent-button",onClick:e=>{e.stopPropagation(),S().catch(x.f)},children:(0,r.jsx)(o.A,{id:"exposedPasswordsConsentCTA"})}),(0,r.jsx)("p",{className:"dark:text-grey-light text-xs text-[--dmd-1]",children:(0,r.jsx)(o.A,{id:"exposedPasswordsConsentCTADescription"})})]}):(0,r.jsxs)("div",{className:"text-red flex items-center text-sm",children:[(0,r.jsx)(q.vXh,{size:16,className:"mr-2"}),(0,r.jsx)(o.A,{id:"errorCode0009"})]});return N?a&&P&&!w?(0,r.jsx)(be,{isLoading:e||E,children:(0,r.jsx)(pe.g,{className:(0,b.cx)(0===t&&"pointer-events-none cursor-default"),title:(0,r.jsx)(ve,{breachedPasswordsCount:t,children:H()}),"data-testid":"password-health-exposed",onClick:()=>{M.FH.action.save(u.ay.ExposedPasswordsOpened),s(ke.Exposed)},children:t>0&&(0,r.jsx)(ue.c,{})})}):(0,r.jsx)(be,{isLoading:e||E,children:(0,r.jsx)($.O,{title:(0,r.jsx)(ve,{breachedPasswordsCount:t,children:H()}),"data-testid":"password-health-exposed"})}):null},Ce=({isLoading:e,weakPasswordCount:s,reusedPasswordCount:a,oldPasswordCount:t,onSectionSelect:n,expirationDurationDays:i=y.O})=>{const{formatMessage:d}=(0,z.A)(),o=(0,g.d4)(f.TI),l=(0,g.d4)(me.GO);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ye,{isLoading:e,onSectionSelect:n}),(0,r.jsx)(be,{isLoading:e,children:(0,r.jsx)(pe.g,{className:(0,b.cx)(0===s&&"pointer-events-none cursor-default"),title:(0,r.jsx)(je,{icon:(0,r.jsx)(q.GwM,{width:19,height:19,className:"nordpass-svg"}),title:d({id:"weakPasswordsTitle"}),description:d({id:"weakPasswordsDescription"}),accountCount:s,titleClassName:"text-red",iconWrapperClassName:"bg-red",testId:"weakpasswords"}),"data-testid":"password-health-weak",onClick:()=>(M.FH.action.save(u.ay.PasswordHealthWeakTap),s>0?n(ke.Weak):null),children:s>0&&(0,r.jsx)(ue.c,{})})}),(0,r.jsx)(be,{isLoading:e,children:(0,r.jsx)(pe.g,{className:(0,b.cx)(0===a&&"pointer-events-none cursor-default"),title:(0,r.jsx)(je,{icon:(0,r.jsx)(q.RI7,{width:16,height:16,className:"nordpass-svg"}),title:d({id:"reusedPasswordsTitle"}),description:d({id:"reusedPasswordsDescription"}),accountCount:a,titleClassName:"text-pink",iconWrapperClassName:"bg-pink",testId:"reusedpasswords"}),"data-testid":"password-health-reused",onClick:()=>(M.FH.action.save(u.ay.PasswordHealthReusedTap),a>0?n(ke.Reused):null),children:a>0&&(0,r.jsx)(ue.c,{})})}),o&&!l&&(0,r.jsx)(be,{isLoading:e,children:(0,r.jsx)(pe.g,{className:(0,b.cx)(0===t&&"pointer-events-none cursor-default"),title:(0,r.jsx)(je,{icon:(0,r.jsx)(q.TRG,{width:19,height:19,className:"nordpass-svg"}),title:d({id:"oldPasswordsTitle"}),description:d({id:"oldPasswordsDescription"},{count:i}),accountCount:t,titleClassName:"text-orange",iconWrapperClassName:"bg-orange",testId:"oldpasswords"}),"data-testid":"password-health-old",onClick:()=>(M.FH.action.save(u.ay.PasswordHealthOldTap),t>0?n(ke.Old):null),children:t>0&&(0,r.jsx)(ue.c,{})})})]})},Ne=({itemGroups:e})=>{const{formatMessage:s}=(0,z.A)();return(0,r.jsx)(r.Fragment,{children:e.map((a,t)=>(0,r.jsx)(K,{items:a,header:(0,r.jsx)("div",{className:"mb-4 text-base font-medium text-grey-dark dark:text-[--dmd-1]",children:s({id:"reusedPasswordMessage"},{repetitions:a.length})}),sectionClassName:(0,b.cx)(e.length>t+1&&"mb-4")},t))})},Ae=({isLoading:e,section:s,weakPasswords:a=[],reusedPasswords:t=[],oldPasswords:n=[],onSectionChange:i})=>{const{rules:d}=(0,R.J)();switch(s){case ke.Weak:return(0,r.jsx)(K,{items:a});case ke.Reused:return(0,r.jsx)(Ne,{itemGroups:t});case ke.Old:return(0,r.jsx)(K,{items:n});case ke.Exposed:return(0,r.jsx)(he,{});default:return(0,r.jsx)(Ce,{isLoading:e,weakPasswordCount:a.length,reusedPasswordCount:t.flat().length,oldPasswordCount:n.length,expirationDurationDays:null==d?void 0:d.expirationDurationDays,onSectionSelect:i})}},Ee=()=>{const e=(0,g.wA)(),[s,a]=(0,n.useState)(),i=(0,n.useMemo)(()=>(e=>{switch(e){case ke.Weak:return(0,r.jsx)(o.A,{id:"weakPasswordsTitle"});case ke.Reused:return(0,r.jsx)(o.A,{id:"reusedPasswordsTitle"});case ke.Old:return(0,r.jsx)(o.A,{id:"oldPasswordsTitle"});case ke.Exposed:return(0,r.jsx)(o.A,{id:"exposedPasswordsTitle"});default:return(0,r.jsx)(o.A,{id:"passwordHealth"})}})(s),[s]),{isFreeUser:R}=(0,p.d)(),z=(0,g.d4)(f.Y4),B=(0,g.d4)(P._H,d()),{isExposedPasswordsEnabled:$,hasAcceptedPasswordHealthConsent:_,isScanningExposedPasswords:D,hasInitiallyScannedVaultPasswords:W,exposedPasswordsScanningError:U}=(0,m.J)(),G=$&&_&&z&&!D&&!W&&!U,{isLoading:Q,refetch:V,data:q}=(0,w.I)((0,n.useCallback)(()=>((e,s)=>{return r=function*(){const a=yield e.vault.getPasswordHealthItems(),r=yield e.password.getPasswordPolicy(),n=(0,k.R)(r),{ownedPasswords:i,weakPasswords:d,reusedPasswords:o,reusedPasswordsExcludingSharedFolder:l,oldPasswords:c,vulnerablePasswords:x}=((e,s,a)=>{const r=e.filter(e=>e.secret&&!(0,S.Dd)(e)),n=r.filter(({secret:e})=>((e,s)=>{if(!e)return!1;const{isPolicyMet:a}=(0,A.m)(e,s);return!a||(0,E.co)(e,N.XX)<t.Moderate})(e,s)),i=(e=>(e=>{const s=e.reduce((e,s)=>{var a,t;return s.secret&&(null!==(a=e[t=s.secret])&&void 0!==a||(e[t]=[]),e[s.secret].push(s)),e},{});return Object.values(s).filter(e=>e.length>1)})(e).sort().reverse())(r),d=((e,s)=>((e,s)=>{const a=e.reduce((e,a)=>{var t,r;return a.folder_id&&s.has(a.folder_id)||a.secret&&(null!==(t=e[r=a.secret])&&void 0!==t||(e[r]=[]),e[a.secret].push(a)),e},{});return Object.values(a).filter(e=>e.length>1)})(e,s).sort().reverse())(r,a),o=r.filter(e=>{var a;return(0,C.G)(e,(null===(a=null==s?void 0:s.rules)||void 0===a?void 0:a.expirationDurationDays)||y.O)}),l=new Array(...new Set([...n,...o,...i.flat()]));return{ownedPasswords:r,weakPasswords:n,reusedPasswords:i,reusedPasswordsExcludingSharedFolder:d,oldPasswords:o,vulnerablePasswords:l}})(a,n,s);return{weakPasswords:d,reusedPasswords:o,reusedPasswordsExcludingSharedFolder:l,oldPasswords:c,vulnerablePasswords:x,ownedPasswords:i}},new((a=void 0)||(a=Promise))(function(e,s){function t(e){try{i(r.next(e))}catch(e){s(e)}}function n(e){try{i(r.throw(e))}catch(e){s(e)}}function i(s){var r;s.done?e(s.value):(r=s.value,r instanceof a?r:new a(function(e){e(r)})).then(t,n)}i((r=r.apply(undefined,[])).next())});var a,r})(M.FH,B),[B]));return(0,n.useEffect)(()=>{var s,a;(s=void 0,a=function*(){G&&(e((0,j.Eg)(!0)),e((0,j.u$)(void 0)),yield M.FH.breachReport.getBreachedPasswords().catch(x.f),e((0,j.Eg)(!1)))},new(s||(s=Promise))(function(e,t){function r(e){try{i(a.next(e))}catch(e){t(e)}}function n(e){try{i(a.throw(e))}catch(e){t(e)}}function i(a){var t;a.done?e(a.value):(t=a.value,t instanceof s?t:new s(function(e){e(t)})).then(r,n)}i((a=a.apply(undefined,[])).next())})).catch(x.f)},[e,G]),(0,n.useEffect)(()=>{M.FH.action.save(u.ay.PasswordHealth)},[]),(0,n.useEffect)(()=>(0,M.pA)(e=>{if((0,H.o)(e)){const s=e.items||[],a=e.deleted_items||[],t=s.filter(S.we),r=a.filter(S.we);(t.length||r.length)&&V().catch(x.f)}}),[V]),R?(0,r.jsx)(I.M,{headerContent:(0,r.jsx)(o.A,{id:"passwordHealth"}),children:(0,r.jsx)(T.n,{buttonText:(0,r.jsx)(o.A,{id:"passwordHealthPromoCTA"}),type:l.e.PasswordHealth,onClick:()=>{M.FH.action.save(u.ay.TapUpgradePasswordHealth),(0,F.t)(c.e.UpgradeButtonPasswordHealth,L.k,"PasswordHealth:handlePremiumClick")}})}):(0,r.jsx)(I.M,{headerContent:i,onGoBack:s?()=>a(void 0):void 0,children:(0,r.jsx)("div",{className:(0,b.cx)("w-full max-w-[1000px] mx-auto",!s&&"grid grid-flow-row gap-4"),children:(0,r.jsx)(Ae,{isLoading:Q,weakPasswords:null==q?void 0:q.weakPasswords,reusedPasswords:null==q?void 0:q.reusedPasswords,oldPasswords:null==q?void 0:q.oldPasswords,section:s,onSectionChange:s=>{R?e((0,O.LQ)({type:v.q.PremiumUpgrade,metadata:{source:h.E.PasswordHealth}})):a(s)}})})})}}}]);
//# sourceMappingURL=42.chunk.js.map